{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import API from\"../api\";import io from\"socket.io-client\";import SensorCard from\"../components/SensorCard\";import{ControlCard as DeviceCard}from'../components/DeviceCard';import SensorChart from\"../components/SensorChart\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const socket=io(\"http://localhost:5000\");export default function Dashboard(){const[sensors,setSensors]=useState([]);useEffect(()=>{API.get(\"/sensors?limit=30\").then(res=>{// sort ascending\nconst sorted=res.data.slice().reverse();setSensors(sorted);});socket.on(\"sensor-data\",d=>{setSensors(prev=>[...prev.slice(-29),d]);// keep last 30\n});return()=>socket.off(\"sensor-data\");},[]);const latest=sensors.length?sensors[sensors.length-1]:null;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold mb-4\",children:\"Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-4 mb-6\",children:[/*#__PURE__*/_jsx(SensorCard,{title:\"Nhi\\u1EC7t \\u0111\\u1ED9\",value:latest?latest.temperature:\"--\",unit:\"\\xB0C\"}),/*#__PURE__*/_jsx(SensorCard,{title:\"\\xC1nh s\\xE1ng\",value:latest?latest.light:\"--\",unit:\"Lux\"}),/*#__PURE__*/_jsx(SensorCard,{title:\"\\u0110\\u1ED9 \\u1EA9m\",value:latest?latest.humidity:\"--\",unit:\"%\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(DeviceCard,{name:\"Nhi\\u1EC7t \\u0111\\u1ED9\",device:\"ac\"}),/*#__PURE__*/_jsx(DeviceCard,{name:\"\\xC1nh s\\xE1ng\",device:\"light\"}),/*#__PURE__*/_jsx(DeviceCard,{name:\"\\u0110\\u1ED9 \\u1EA9m\",device:\"fan\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsx(SensorChart,{data:sensors})})]})]});}","map":{"version":3,"names":["React","useEffect","useState","API","io","SensorCard","ControlCard","DeviceCard","SensorChart","jsx","_jsx","jsxs","_jsxs","socket","Dashboard","sensors","setSensors","get","then","res","sorted","data","slice","reverse","on","d","prev","off","latest","length","children","className","title","value","temperature","unit","light","humidity","name","device"],"sources":["D:/xampp/htdocs/IoT/IoT-WebApp/frontend/src/pages/Dashboard.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport API from \"../api\";\r\nimport io from \"socket.io-client\";\r\nimport SensorCard from \"../components/SensorCard\";\r\nimport { ControlCard as DeviceCard } from '../components/DeviceCard';\r\n\r\nimport SensorChart from \"../components/SensorChart\";\r\n\r\nconst socket = io(\"http://localhost:5000\");\r\n\r\nexport default function Dashboard(){\r\n    const [sensors, setSensors] = useState([]);\r\n    useEffect(()=>{\r\n        API.get(\"/sensors?limit=30\").then(res => {\r\n            // sort ascending\r\n            const sorted = res.data.slice().reverse();\r\n            setSensors(sorted);\r\n        });\r\n        socket.on(\"sensor-data\", (d) => {\r\n            setSensors(prev => [...prev.slice(-29), d]); // keep last 30\r\n        });\r\n        return ()=> socket.off(\"sensor-data\");\r\n    },[]);\r\n\r\n    const latest = sensors.length ? sensors[sensors.length-1] : null;\r\n\r\n    return (\r\n        <div>\r\n            <h1 className=\"text-2xl font-bold mb-4\">Dashboard</h1>\r\n            <div className=\"grid grid-cols-3 gap-4 mb-6\">\r\n                <SensorCard title=\"Nhiệt độ\" value={latest ? latest.temperature : \"--\"} unit=\"°C\" />\r\n                <SensorCard title=\"Ánh sáng\" value={latest ? latest.light : \"--\"} unit=\"Lux\" />\r\n                <SensorCard title=\"Độ ẩm\" value={latest ? latest.humidity : \"--\"} unit=\"%\" />\r\n            </div>\r\n\r\n            <div className=\"flex gap-6\">\r\n                <div className=\"space-y-4\">\r\n                    <DeviceCard name=\"Nhiệt độ\" device=\"ac\" />\r\n                    <DeviceCard name=\"Ánh sáng\" device=\"light\" />\r\n                    <DeviceCard name=\"Độ ẩm\" device=\"fan\" />\r\n                </div>\r\n\r\n                <div className=\"flex-1\">\r\n                    <SensorChart data={sensors} />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}